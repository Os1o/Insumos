<!-- Header Administrativo Compartido -->
<header class="header admin-header-nav">
    <div class="container">
        <div class="header-content">
            <!-- Logo Administrativo -->
            <div class="logo-section">
                <div class="logo-icon admin-logo">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                </div>
                <div class="logo-text">
                    <h1>Panel Administrativo</h1>
                    <span class="admin-role-badge" id="adminRoleBadge">Administrador</span>
                </div>
            </div>

            <!-- Navegación Principal Admin -->
            <nav class="main-nav admin-nav">
                <ul class="nav-links">
                    <li>
                        <a href="admin.html" class="nav-link admin-nav-link" id="navPanelAdmin">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            </svg>
                            Panel Admin
                        </a>
                    </li>
                    <li>
                        <a href="inventario.html" class="nav-link admin-nav-link super-admin-only" id="navInventario" style="display: none;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                <circle cx="12" cy="12" r="4"/>
                            </svg>
                            Inventario
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- Sección de Usuario Admin -->
            <div class="user-section admin-user-section">
                <div class="admin-quick-stats" id="adminQuickStats">
                    <!-- Estadísticas rápidas se cargan aquí -->
                </div>
                
                <div class="user-menu">
                    <button class="user-button admin-user-button" onclick="toggleAdminUserMenu()">
                        <div class="user-avatar admin-avatar">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <div class="user-info">
                            <span class="user-name" id="adminUserName">Administrador</span>
                            <span class="user-role" id="adminUserRole">admin</span>
                        </div>
                        <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6,9 12,15 18,9"/>
                        </svg>
                    </button>

                    <!-- Dropdown del Usuario Admin -->
                    <div class="user-dropdown admin-user-dropdown" id="adminUserDropdown" style="display: none;">
                        <div class="dropdown-header admin-dropdown-header">
                            <div class="user-info">
                                <div class="user-avatar-large admin-avatar-large">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                </div>
                                <div class="user-details">
                                    <span class="user-display-name" id="adminDisplayName">Administrador</span>
                                    <span class="user-email" id="adminEmail">admin@empresa.com</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dropdown-menu">
                            <a href="index.html" class="dropdown-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                                    <polyline points="9,22 9,12 15,12 15,22"/>
                                </svg>
                                Volver a Usuario
                            </a>
                            <a href="#" class="dropdown-item" onclick="mostrarEstadoSistema()">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"/>
                                    <path d="M12 1v6m0 6v6m11-7h-6M7 12H1"/>
                                </svg>
                                Estado del Sistema
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="login.html" class="dropdown-item logout" onclick="logoutAdmin()">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                                    <polyline points="16,17 21,12 16,7"/>
                                    <line x1="21" y1="12" x2="9" y2="12"/>
                                </svg>
                                Cerrar Sesión Admin
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Botón de menú móvil -->
                <button class="mobile-menu-btn admin-mobile-btn" onclick="toggleAdminMobileMenu()">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </div>
        </div>

        <!-- Menú móvil admin -->
        <div class="mobile-menu admin-mobile-menu" id="adminMobileMenu" style="display: none;">
            <div class="mobile-nav">
                <a href="admin.html" class="mobile-nav-link">Panel Admin</a>
                <a href="inventario.html" class="mobile-nav-link super-admin-only" style="display: none;">Inventario</a>
                <div class="mobile-divider"></div>
                <a href="index.html" class="mobile-nav-link">Volver a Usuario</a>
                <a href="login.html" class="mobile-nav-link logout" onclick="logoutAdmin()">Cerrar Sesión</a>
            </div>
        </div>
    </div>
</header>

<!-- Overlay para cerrar menús móviles -->
<div class="mobile-overlay admin-mobile-overlay" id="adminMobileOverlay" onclick="closeAdminMobileMenus()"></div>

<!-- Script específico del header admin -->
<script>
// Variables globales del header admin
let currentAdminUser = null;

// Inicialización del header admin
document.addEventListener('DOMContentLoaded', function() {
    initializeAdminHeader();
});

function initializeAdminHeader() {
    // Obtener usuario actual
    const session = sessionStorage.getItem('currentUser');
    if (!session) {
        window.location.href = 'login.html';
        return;
    }
    
    try {
        currentAdminUser = JSON.parse(session);
        updateAdminUserInfo();
        configurarNavegacionSegunRol();
        marcarPaginaActiva();
    } catch (error) {
        console.error('Error inicializando header admin:', error);
        window.location.href = 'login.html';
    }
}

function updateAdminUserInfo() {
    if (!currentAdminUser) return;
    
    // Actualizar información del usuario
    document.getElementById('adminUserName').textContent = currentAdminUser.nombre;
    document.getElementById('adminUserRole').textContent = currentAdminUser.rol;
    document.getElementById('adminDisplayName').textContent = currentAdminUser.nombre;
    document.getElementById('adminEmail').textContent = currentAdminUser.username + '@empresa.com';
    
    // Actualizar badge de rol
    const roleBadge = document.getElementById('adminRoleBadge');
    if (currentAdminUser.rol === 'super_admin') {
        roleBadge.textContent = 'Super Administrador';
        roleBadge.style.background = 'linear-gradient(135deg, #8e44ad, #9b59b6)';
    } else {
        roleBadge.textContent = 'Administrador';
        roleBadge.style.background = 'linear-gradient(135deg, #657153, #8aaa79)';
    }
}

function configurarNavegacionSegunRol() {
    if (currentAdminUser.rol === 'super_admin') {
        // Mostrar elementos exclusivos de super admin
        document.querySelectorAll('.super-admin-only').forEach(element => {
            element.style.display = 'block';
        });
    }
}

function marcarPaginaActiva() {
    // Marcar página actual como activa
    const currentPage = window.location.pathname;
    const navLinks = document.querySelectorAll('.admin-nav-link');
    
    navLinks.forEach(link => {
        link.classList.remove('active');
        if (currentPage.includes(link.getAttribute('href'))) {
            link.classList.add('active');
        }
    });
}

// Funciones del menú de usuario
function toggleAdminUserMenu() {
    const dropdown = document.getElementById('adminUserDropdown');
    const isVisible = dropdown.style.display !== 'none';
    
    if (isVisible) {
        closeAdminUserDropdown();
    } else {
        dropdown.style.display = 'block';
        dropdown.style.animation = 'modalSlideIn 0.2s ease';
    }
}

function closeAdminUserDropdown() {
    const dropdown = document.getElementById('adminUserDropdown');
    if (dropdown) {
        dropdown.style.display = 'none';
    }
}

// Funciones del menú móvil
function toggleAdminMobileMenu() {
    const mobileMenu = document.getElementById('adminMobileMenu');
    const mobileOverlay = document.getElementById('adminMobileOverlay');
    
    if (mobileMenu && mobileOverlay) {
        const isVisible = mobileMenu.style.display !== 'none';
        
        if (isVisible) {
            closeAdminMobileMenus();
        } else {
            mobileMenu.style.display = 'block';
            mobileOverlay.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
    }
}

function closeAdminMobileMenus() {
    const mobileMenu = document.getElementById('adminMobileMenu');
    const mobileOverlay = document.getElementById('adminMobileOverlay');
    
    if (mobileMenu) mobileMenu.style.display = 'none';
    if (mobileOverlay) mobileOverlay.style.display = 'none';
    document.body.style.overflow = '';
    closeAdminUserDropdown();
}

// Funciones auxiliares
function mostrarEstadoSistema() {
    // Implementar modal de estado del sistema
    alert('Estado del Sistema: Operativo\nBase de Datos: Conectada\nInventario: Actualizado');
}

function logoutAdmin() {
    sessionStorage.removeItem('currentUser');
    localStorage.removeItem('userSession');
    window.location.href = 'login.html';
}

// Cerrar dropdowns al hacer click fuera
document.addEventListener('click', function(e) {
    if (!e.target.closest('.user-menu')) {
        closeAdminUserDropdown();
    }
});
</script>

<!-- Estilos específicos del header admin -->
<style>
.admin-header-nav {
    background: linear-gradient(135deg, #657153, #8aaa79);
    border-bottom: 2px solid rgba(255, 255, 255, 0.2);
}

.admin-logo {
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
}

.admin-role-badge {
    display: inline-block;
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 12px;
    margin-top: 0.25rem;
    font-weight: 500;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

.admin-nav-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    border-radius: 8px;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid transparent;
}

.admin-nav-link:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.3);
    transform: translateY(-1px);
}

.admin-nav-link.active {
    background: rgba(255, 255, 255, 0.25);
    border-color: rgba(255, 255, 255, 0.4);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.admin-user-button {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 0.75rem 1rem;
    border-radius: 10px;
    transition: all 0.3s ease;
}

.admin-user-button:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.4);
    transform: translateY(-1px);
}

.user-role {
    font-size: 0.8rem;
    opacity: 0.8;
    text-transform: capitalize;
}

.admin-dropdown-header {
    background: linear-gradient(135deg, #657153, #8aaa79);
}

.admin-quick-stats {
    display: flex;
    gap: 1rem;
    margin-right: 1rem;
    align-items: center;
}

.quick-stat {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.5rem 0.75rem;
    border-radius: 6px;
    text-align: center;
    min-width: 60px;
}

.quick-stat-number {
    display: block;
    font-weight: bold;
    font-size: 1.1rem;
}

.quick-stat-label {
    font-size: 0.7rem;
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

@media (max-width: 768px) {
    .admin-quick-stats {
        display: none;
    }
    
    .admin-role-badge {
        display: none;
    }
}
</style>